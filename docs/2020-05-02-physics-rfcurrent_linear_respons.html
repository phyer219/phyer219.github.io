<!DOCTYPE html>
<html lang="zh_cn">

<head>
    <title>从冰上的水 - 由 rf current 的定义推导其格林函数的表达形式</title>
  <meta charset="utf-8" />
  <meta name="generator" content="Pelican" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link
    href="https://zqw.ink/feeds/all.atom.xml"
    type="application/atom+xml" rel="alternate" title="从冰上的水 Full Atom Feed" />
  <link
    href="https://zqw.ink/feeds/zhuan-ye-bi-ji.atom.xml"
    type="application/atom+xml" rel="alternate" title="从冰上的水 Categories Atom Feed" />
  <link rel="stylesheet" type="text/css" href="https://zqw.ink/theme/css/style.css" />
  <!-- fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Long+Cang&family=Noto+Serif+SC&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.6.1/github-markdown.min.css" integrity="sha512-wpdV3v8V8vWajD1kH8rI1UO1H2q9TQ3s8o1mG7lH8fS1dZ+3q1B1p4lH2tF8rQm2u0n8oV6rN3tV4nQWmY4nTw==" crossorigin="anonymous" referrerpolicy="no-referrer">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  <!--fonts end  -->
  <!-- highlight.js -->
  <link id="hljs-light" rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" disabled>
  <link id="hljs-dark" rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" disabled>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
    (function () {
      const light = document.getElementById('hljs-light');
      const dark = document.getElementById('hljs-dark');
      if (!light || !dark) return;

      function resolveTheme() {
        return document.documentElement.getAttribute('data-theme') || 'light';
      }

      function applyTheme(theme) {
        const isDark = theme === 'dark';
        light.disabled = isDark;
        dark.disabled = !isDark;
      }

      const observer = new MutationObserver(function () {
        applyTheme(resolveTheme());
      });
      observer.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });
      applyTheme(resolveTheme());
    })();
  </script>
  <!-- highlight.js end -->

<script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        tags: 'ams'   // 自动给 AMS 环境/显示公式编号
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.1">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.1">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.1">




    <meta name="tags" content="物理" />
    <meta name="tags" content="rf current" />
    <meta name="tags" content="linear repsonse" />
    <meta name="tags" content="Green's Function" />

</head>

<body>
  <header>
    <div id="header-container">
      <button id="nav-toggle" class="nav-toggle" aria-label="打开菜单" aria-expanded="false">
        <i class="fa-solid fa-bars" aria-hidden="true"></i>
      </button>
      <nav id="site-nav">
        <ul>
            <li>
              <a href="/">Home</a>
            </li>
            <li>
              <a href="/category/physics">Physics</a>
            </li>
            <li>
              <a href="/category/blog">Blog</a>
            </li>
            <li>
              <a href="/category/coding">Coding</a>
            </li>
            <li>
              <a href="/archives">All</a>
            </li>
          </ul>
      </nav>
      <div class="header-actions">
        <button id="theme-toggle" aria-label="切换到深色模式" title="切换主题">
          <i class="theme-icon icon-sun fa-solid fa-sun" aria-hidden="true"></i>
          <i class="theme-icon icon-moon fa-solid fa-moon" aria-hidden="true"></i>
        </button>
        <div class="rss">
            <a href="https://zqw.ink/feeds/all.atom.xml" aria-label="Atom 订阅">
              <i class="fa-solid fa-rss" aria-hidden="true"></i>
            </a>
        </div>
      </div>
    </div>
  </header>
  <main>

<h1 class="post-title">由 rf current 的定义推导其格林函数的表达形式</h1>

<section class="post-meta">
    <p>2020-05-02</p>
    <p>-<a class="post-link" href="https://zqw.ink/category/zhuan-ye-bi-ji.html">专业笔记</a></p>
</section>

<section class="markdown-body">
  
<h2>问题描述</h2>

<p>通过计算, 探究 rf current, 也就是粒子数对时间的导数, 与 Green's function 的关系. </p>

<h2>Hamiltonian</h2>

<p>考虑不同 hyperfine state 上的 Fermi 原子. 不同的 hyperfine state 用希腊字母下
标表示( e.g. $\sigma, \alpha, \beta$ ) 它的 internal nergy 为 $E_{\sigma}$ , 受到的 external
trapping potential 为 $V_{T,\sigma}(\vec{r})$ 它们之间的相互作用势为 $V_{\alpha,
\beta}(\vec{r}, \vec{r}')$. 其中两个 hyperfine state $e, g$ 由外场 $\Omega(\vec{r}, t)$
couple. 整个系统的 Hamiltonia 为</p>

$$\begin{align}
  \hat{H}_{C} = \hat{H}_{0C} + \hat{H}_{L}(t)
\end{align}$$

<p>第一项是系统本身的项</p>

$$\begin{align}
  \hat{H}_{0C} =& \int \mathrm{d}^3r \sum_{\sigma} \hat{\psi}_{\sigma}^{\dagger}(\vec{r})\left( 
    -\frac{\hbar^2\nabla^2}{2m_{\sigma}} + E_{\sigma} + V_{T,\sigma}(\vec{r})
  \right)\hat{\psi}_{\sigma}(\vec{r}) \\
  &+ \frac{1}{2}\sum_{\alpha,\beta} \int \mathrm{d}^3r \int \mathrm{d}^3r'\cdot
   \hat{\psi}_{\alpha}^{\dagger}(\vec{r})\hat{\psi}_{\beta}^{\dagger}(\vec{r}')
   V_{\alpha,\beta}(\vec{r},\vec{r}')
   \hat{\psi}_{\beta}(\vec{r}')\hat{\psi}_{\alpha}(\vec{r})
\end{align}$$

<p>第二项是外场对 $e, g$ 的 couple</p>

$$\begin{align}
  \hat{H}'_{L}(t) = \int \mathrm{d}^3 r \left[ 
   \hbar\Omega(\vec{r}, t) \hat{\psi}_{e}^{\dagger}(\vec{r})\hat{\psi}_{g}(\vec{r}) + \mathrm{h.c.} 
  \right]
\end{align}$$

<p>这里的二次量子化形式可以理解成, 对 $e, g$ 来说, 它是非本征表象的单体算符, 而对
$\vec{r}$ 来说它是本征表象的单体算符.</p>

<p>下标 $C$ 代表 canonical ,正则系宗, 因为 $H'_{L}(t)$ 使得粒子数不守恒.</p>

<p>把时间演化全都放到算符上, 也就是在 Heisenberg picture, rf current 定义为 $e$ 态
上的粒子数随时间的变化</p>

$$\begin{align}
  \frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi|\hat{N}_{e}(t)|\Psi\rangle
\end{align}$$

<p>其中粒子数算符为对粒子数密度算符的积分</p>

$$\begin{align}
  \hat{N}_e(t) = \int \mathrm{d}^3r \cdot \hat{\psi}_e^{\dagger}(\vec{r}, t) \hat{\psi}_e(\vec{r}, t)
\end{align}$$


<h2>Heisenberg 运动方程</h2>

<p>根据 Heisenberg picture 的运动方程</p>

$$\begin{align}
  \mathrm{i}\hbar\frac{\mathrm{d}}{\mathrm{d}t}\left[\hat{\psi}_e^{\dagger}(\vec{r}, t) \hat{\psi}_e(\vec{r}, t)\right]
  = \left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{H}_{0C} + \hat{H}'_{L}(t)\right](t)
\end{align}$$

<p>其中关于 $\hat{H}_{0C}$ 的对易子为零, 只有 couple 项 $\hat{H}'_{L}$ 才会对粒子数
密度的演化有影响. 下面进行计算</p>

$$\begin{align}
  &\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{H}'_{L}(t)\right] \\
 =&\int \mathrm{d}^3 r'\left\{ \hbar\Omega(\vec{r}',t)\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')\hat{\psi}_{g}(\vec{r}')  \right]
  + \hbar\Omega^{*}(\vec{r}',t)\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_g^{\dagger}(\vec{r}')\hat{\psi}_e(\vec{r}')  \right]\right\}
\end{align}$$

<p>先算第一项</p>

$$\begin{align}
  \hbar\Omega(\vec{r}',t)\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')\hat{\psi}_{g}(\vec{r}')  \right]
  = \hbar\Omega(\vec{r}',t)&\left\{\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')  \right]\hat{\psi}_{g}(\vec{r}')\right. \\
   &\left. +\hat{\psi}_{e}^{\dagger}(\vec{r}') \left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{g}(\vec{r}')  \right] \right\}
\end{align}$$

<p>对于 Fermion 有</p>

$$\begin{align}
  \left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')  \right]
  =&  \hat{\psi}_e^{\dagger}(\vec{r}) \left\{ \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')  \right\}
    -\left\{\hat{\psi}_e^{\dagger}(\vec{r})  , \hat{\psi}_{e}^{\dagger}(\vec{r}')  \right\}\hat{\psi}_e(\vec{r}) \\
  =&  \hat{\psi}_e^{\dagger}(\vec{r}) \cdot \delta(\vec{r}-\vec{r}') - 0\cdot \hat{\psi}_e(\vec{r})  
  = \hat{\psi}_e^{\dagger}(\vec{r})\delta(\vec{r}-\vec{r}')
\end{align}$$

<p>式中 $\{ A,B \} = AB + BA$ 为反对易子.</p>

$$\begin{align}
  \left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{g}(\vec{r})  \right]
  = 0
\end{align}$$

<p>所以</p>

$$\begin{align}
  \hbar\Omega(\vec{r}',t)\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_{e}^{\dagger}(\vec{r}')\hat{\psi}_{g}(\vec{r}')  \right]
  = \hbar\Omega(\vec{r}',t)\hat{\psi}_e^{\dagger}(\vec{r})\hat{\psi}_{g}(\vec{r}')\delta(\vec{r} - \vec{r}')
\end{align}$$

<p>同理</p>

$$\begin{align}
  \hbar\Omega^{ * }(\vec{r}',t)\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{\psi}_g^{\dagger}(\vec{r}')\hat{\psi}_e(\vec{r}')  \right]
  = - \hbar\Omega^{ * }(\vec{r}',t)\hat{\psi}_g^{\dagger}(\vec{r}')\hat{\psi}_e(\vec{r})\delta(\vec{r} - \vec{r}')
\end{align}$$

<p>那么算得所需要的对易关系为</p>

$$\begin{align}
  &\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{H}'_{L}(t)\right] \\
 =&\int \mathrm{d}^3 r'\left\{ \hbar\Omega(\vec{r}',t)\hat{\psi}_e^{\dagger}(\vec{r})\hat{\psi}_{g}(\vec{r}')\delta(\vec{r} - \vec{r}') 
  - \hbar\Omega^{*}(\vec{r}',t)\hat{\psi}_g^{\dagger}(\vec{r}')\hat{\psi}_e(\vec{r})\delta(\vec{r} - \vec{r}') \right\} \\
 = &\hbar\Omega(\vec{r},t)\hat{\psi}_e^{\dagger}(\vec{r})\hat{\psi}_{g}(\vec{r})
  - \hbar\Omega^{*}(\vec{r},t)\hat{\psi}_g^{\dagger}(\vec{r})\hat{\psi}_e(\vec{r})
\end{align}$$

<p>所以 $e$ 态上粒子数随时间的变化在 Heisenberg 表象中为</p>

$$\begin{align}
  \frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi|\hat{N}_{e}(t)|\Psi\rangle
  =& \int \mathrm{d}^3r\langle \Psi \left|\frac{\mathrm{d}}{\mathrm{d}t}\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)  \hat{\psi}_e(\vec{r}, t)\right]\right|\Psi\rangle \\
  =& \frac{1}{\mathrm{i}\hbar}\int \mathrm{d}^3r\langle \Psi \left|\left[\hat{\psi}_e^{\dagger}(\vec{r}) \hat{\psi}_e(\vec{r}) , \hat{H}'_{L}(t)\right](t)\right|\Psi\rangle \\
  =& \frac{1}{\mathrm{i}\hbar}\int \mathrm{d}^3r\cdot
     \left[ \hbar\Omega(\vec{r},t)\langle\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t)\rangle
    - \hbar\Omega^{*}(\vec{r},t)\langle\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t)\rangle \right]
\end{align}$$

<p>其中 $\langle \rangle$ 是 $\langle\Psi||\Psi\rangle$ 的简写.</p>

<h2>线性响应</h2>

<p>现在已经通过 Heisenberg 运动方程, 将原来问题中算符导数的平均, 变成了对关联函数的
平均. 接下来已经不能严格求解了, 要将 couple $\hat{H}'_{L}(t)$ 作为微扰, 在相互作用
表象中进行线性近似.</p>

<p>以下讨论都是在相互作用表象.</p>

<p>在相互作用表象中, 一个态矢的演化由演化算符给出(取 $t_0=0$ )</p>

$$\begin{align}
  |\Psi(t)\rangle = U(t) |\Psi\rangle
\end{align}$$

<p>其中</p>

$$\begin{align}
  U(t) = T \left\{ e^{\frac{1}{\mathrm{i}\hbar}\int_0^t \mathrm{d}t'\cdot \hat{H}_{L}(t')} \right\}
\end{align}$$

<p>这里 $\hat{H}_L(t) = e^{\frac{\mathrm{i}}{\hbar}\hat{H}_{0C}(t)} \hat{H}'_L(t)
e^{-\frac{\mathrm{i}}{\hbar}\hat{H}_{0C}(t)}$ , 也就是 $\hat{H}'_L(t)$ 去掉 $'$ 后,
表示它在相互作用表象中.</p>

<p>对于一个相互作用表象中的算符 $\hat{O}(t) =
e^{\frac{\mathrm{i}}{\hbar}\hat{H}_{0C}(t)} \hat{O}
e^{-\frac{\mathrm{i}}{\hbar}\hat{H}_{0C}(t)}$ , 它在 $t$ 时刻的期望为 </p>

$$\begin{align}
  \langle\Psi(t)| \hat{O} |\Psi(t)\rangle = \langle U^{\dagger} (t) \hat{O}(t) U(t)\rangle
\end{align}$$

<p>其中 $\langle \rangle$ 是 $\langle\Psi(0)| |\Psi(0)\rangle$ 的简写. 把演化算符的表达式代入, 按 $\hat{H}_{L}(t)$ 的展开, 得</p>

$$\begin{align}
  \langle\Psi(t)| \hat{O}(t)|\Psi(t) \rangle = \langle \hat{O}(t) \rangle + \langle \hat{O} \rangle_{1\mathrm{st}} +
  \langle \hat{O} \rangle_{2\mathrm{nd}} + \cdots
\end{align}$$

<p>其中</p>

$$\begin{align}
  \langle \hat{O} \rangle_{1\mathrm{st}} =& \frac{1}{\mathrm{i}\hbar}\int_0^t\mathrm{d}t'
  \langle\left[\hat{O}(t), \hat{H}_L(t')  \right]\rangle \\
  = & \frac{1}{\mathrm{i}\hbar}\int_0^{\infty}\mathrm{d}t' \cdot
   \theta(t - t')\langle\left[\hat{O}(t), \hat{H}_L(t')  \right]\rangle \\
  =& \int_0^{\infty} \mathrm{d}t' \cdot \chi(t, t')
\end{align}$$

<p>这里定义了</p>

$$\begin{align}
  \chi(t, t') = \frac{1}{i\hbar}\theta(t - t')\langle\left[\hat{O}(t), \hat{H}_L(t')  \right]\rangle
\end{align}$$


<h2>应用线性响应, 并扔掉两项</h2>

<p>rf current 在相互作用表象中可以写成</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle \\
  =& \frac{1}{\mathrm{i}\hbar}\int \mathrm{d}^3r\cdot
     \left[ \hbar\Omega(\vec{r},t)\langle\Psi(t)|\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r},t)|\Psi(t)\rangle
    - \hbar\Omega^{*}(\vec{r},t)\langle\Psi(t)|\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t)|\Psi(t)\rangle \right]
\end{align}$$

<p>利用线性响应的结果计算两项均值. 第一项</p>

$$\begin{align}
  &\hbar\Omega(\vec{r},t)\langle\Psi(t)|\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t)|\Psi(t)\rangle_{1\mathrm{st}} \\
 =& \frac{1}{\mathrm{i}\hbar} \int_0^{\infty}\mathrm{d}t'\cdot \hbar\Omega(\vec{r}, t)\theta(t - t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t), \hat{H}_L(t')  \right]\rangle 
\end{align}$$

<p>将 $\hat{H}_{L}(t')$ 的具体形式</p>

$$\begin{align}
  \hat{H}_{L}(t') = \int \mathrm{d}^3 r' \left[ 
   \hbar\Omega(\vec{r}', t') \hat{\psi}_{e}^{\dagger}(\vec{r}', t')\hat{\psi}_{g}(\vec{r}', t') + \mathrm{h.c.} 
  \right]
\end{align}$$

<p>代入后</p>

$$\begin{align}
  &\hbar\Omega(\vec{r},t)\langle\Psi(t)|\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t)|\Psi(t)\rangle_{1\mathrm{st}} \\
 =& \frac{\hbar}{\mathrm{i}} \int_0^{\infty}\mathrm{d}t'\int \mathrm{d}^3 r'\cdot \theta(t - t')\Omega(\vec{r}, t)\Omega(\vec{r}', t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_{e}^{\dagger}(\vec{r}', t')\hat{\psi}_{g}(\vec{r}', t') \right]\rangle \\
+& \frac{\hbar}{\mathrm{i}} \int_0^{\infty}\mathrm{d}t'\int \mathrm{d}^3 r'\cdot \theta(t - t')\Omega(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_g^{\dagger}(\vec{r}', t')\hat{\psi}_e(\vec{r}', t') \right]\rangle 
\end{align}$$

<p>同理, 第二项</p>

$$\begin{align}
  &-\hbar\Omega(\vec{r},t)\langle\Psi(t)|\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t)|\Psi(t)\rangle_{1\mathrm{st}} \\
 =&- \frac{\hbar}{\mathrm{i}} \int_0^{\infty}\mathrm{d}t'\int \mathrm{d}^3 r'\cdot \theta(t - t')\Omega^{*}(\vec{r}, t)\Omega(\vec{r}', t')
    \langle\left[\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t),  \hat{\psi}_{e}^{\dagger}(\vec{r}', t')\hat{\psi}_{g}(\vec{r}', t') \right]\rangle \\
-& \frac{\hbar}{\mathrm{i}} \int_0^{\infty}\mathrm{d}t'\int \mathrm{d}^3 r'\cdot \theta(t - t')\Omega^{ * }(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t),  \hat{\psi}_g^{\dagger}(\vec{r}', t')\hat{\psi}_e(\vec{r}', t') \right]\rangle 
\end{align}$$

<p>所以 $\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle$ 中的一阶项中出现
了如下四项</p>

$$\begin{align}
  &\Omega(\vec{r}, t)\Omega(\vec{r}', t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_{e}^{\dagger}(\vec{r}', t')\hat{\psi}_{g}(\vec{r}', t') \right]\rangle \\
  &\Omega(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_g^{\dagger}(\vec{r}', t')\hat{\psi}_e(\vec{r}', t') \right]\rangle \\
  -&\Omega^{*}(\vec{r}, t)\Omega(\vec{r}', t')
    \langle\left[\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t),  \hat{\psi}_{e}^{\dagger}(\vec{r}', t')\hat{\psi}_{g}(\vec{r}', t') \right]\rangle \\
  -&\Omega^{ * }(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_g^{\dagger}(\vec{r}, t)\hat{\psi}_e(\vec{r}, t),  \hat{\psi}_g^{\dagger}(\vec{r}', t')\hat{\psi}_e(\vec{r}', t') \right]\rangle 
\end{align}$$

<p>上面四项中, 第一项和第四项互为复共轭, 第二项和第三项互为复共轭. </p>

<p>在第一项和第四项中出现了同一个态上有两个产生或湮灭算符的形式, 比如
$\hat{\psi}_e\hat{\psi}_e$ . 书上的推导把它们扔掉了, 它说</p>
<blockquote>become zero unless the state possesses some special correlations requiring a
non-trivial many-body state. </blockquote>
<p>在 rf 谱中, 它就是零</p>
<blockquote>when taking the expectation values,RF spectroscopy where the species labeled by e is in the normal state:
then this type of terms is certainly zero. </blockquote>
<p>但是</p>
<blockquote>But in general one should keep in mind that terms of the form
$\hat{\psi}^{\dagger}_{\sigma}(\vec{r}, t)\hat{\psi}^{\dagger}_{\sigma}(\vec{r}, t)$ exist as well and
might be relevant since they basically describe correlations within each
species. </blockquote>
<p>扔掉这两项后, 就变成了</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}} \\
  =& -\int \mathrm{d}^3r \int \mathrm{d}r'\int_0^{\infty} \mathrm{d}t' \cdot\theta(t - t')
    \left\{\Omega(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_e^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_g^{\dagger}(\vec{r}', t')\hat{\psi}_e(\vec{r}', t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$


<h2>Rotating Wave Approximation</h2>

<p>现在做一个 trick. 原因在书上(待会补充)</p>

<p>上面在相互作用表象中的算符, 都是由 $\hat{H}_{0C}$ 演化的. 是巨正则系统, 没有化学
势. 现在定义一个新的 $\hat{H}_{0}$ , 让它包含化学势, 也就是</p>

$$\begin{align}
  \hat{H}_{0} = \hat{H}_{0C} - \hat{H}_{\mu}
\end{align}$$

<p>其中</p>

$$\begin{align}
  \hat{H}_{\mu} = \int \mathrm{d}^3r\sum_{\sigma}\hat{\psi}_{\sigma}^{\dagger}(\vec{r})( \mu_{\sigma} + E_{\sigma})\hat{\psi}_{\sigma}(\vec{r})
\end{align}$$


$$\begin{align}
  \hat{H}_{0} =& \int \mathrm{d}^3r \sum_{\sigma} \hat{\psi}_{\sigma}^{\dagger}(\vec{r})\left( 
    -\frac{\hbar^2\nabla^2}{2m_{\sigma}} - \mu_{\sigma} + V_{T,\sigma}(\vec{r})
  \right)\hat{\psi}_{\sigma}(\vec{r}) \\
  &+ \frac{1}{2}\sum_{\alpha,\beta} \int \mathrm{d}^3r \int \mathrm{d}^3r'\cdot
   \hat{\psi}_{\alpha}^{\dagger}(\vec{r})\hat{\psi}_{\beta}^{\dagger}(\vec{r}')
   V_{\alpha,\beta}(\vec{r},\vec{r}')
   \hat{\psi}_{\beta}(\vec{r}')\hat{\psi}_{\alpha}(\vec{r})
\end{align}$$

<p>这样的话就有</p>

$$\begin{align}
  \hat{\psi}_{\sigma}^{\dagger}(\vec{r}, t) =  e^{\frac{\mathrm{i}}{\hbar}\hat{H}_0t}
    \left[ e^{\frac{\mathrm{i}}{\hbar}\hat{H}_{\mu}t} \hat{\psi}_{\sigma}^{\dagger}(\vec{r}) 
    e^{\frac{-\mathrm{i}}{\hbar}\hat{H}_{\mu}t} \right] e^{\frac{-\mathrm{i}}{\hbar}\hat{H}_0t}
\end{align}$$

<p>由 Heisenberg 运动方程可知</p>

$$\begin{align}
   \mathrm{i}\hbar \frac{\mathrm{d}}{\mathrm{d}t}\left[ 
   e^{\frac{\mathrm{i}}{\hbar}\hat{H}_{\mu}t} \hat{\psi}_{\sigma}^{\dagger}(\vec{r}) 
    e^{\frac{-\mathrm{i}}{\hbar}\hat{H}_{\mu}t} \right] 
  = \left[\hat{\psi}_{\sigma}^{\dagger}(\vec{r}) , \hat{H}_{\mu} \right] 
  = -(\mu_{\sigma} + E_{\sigma})\hat{\psi}_{\sigma}^{\dagger}(\vec{r})
\end{align}$$

<p>所以</p>

$$\begin{align}
   e^{\frac{\mathrm{i}}{\hbar}\hat{H}_{\mu}t} \hat{\psi}_{\sigma}^{\dagger}(\vec{r}) 
    e^{\frac{-\mathrm{i}}{\hbar}\hat{H}_{\mu}t} 
  = \hat{\psi}_{\sigma}^{\dagger} e^{\frac{\mathrm{i}}{\hbar}(\mu_{\sigma} + E_{\sigma} )t}
\end{align}$$

<p>下面的 $\hat{\psi}_{\sigma}^{\dagger}(\vec{r}, t)$ 重新定义为</p>

$$\begin{align}
  \hat{\psi}_{\sigma}^{\dagger}(\vec{r}, t) \equiv e^{\frac{\mathrm{i}}{\hbar}(\mu_{\sigma}+ E_{\sigma} )t}
     e^{\frac{\mathrm{i}}{\hbar}\hat{H}_0t}
     \hat{\psi}_{\sigma}^{\dagger}(\vec{r}) 
\end{align}$$

<p>那么 (之前的产生煙灭算符都应该带下标 $C$ 的, 下次复习的时候再添吧) </p>

$$\begin{align}
  \hat{\psi}_{\sigma C}^{\dagger}(\vec{r}, t) = e^{\frac{\mathrm{i}}{\hbar}(\mu_{\sigma} + E_{\sigma} )t}
     \hat{\psi}_{\sigma}^{\dagger}(\vec{r}, t)
\end{align}$$

<p>对于偶合, 假设是如下振动</p>

$$\begin{align}
  \Omega(\vec{r}, t) = \Omega(\vec{r}) \sin (\omega_Lt) = \Omega(\vec{r}) 
              \frac{e^{\mathrm{i}\omega_Lt} - e^{-\mathrm{i}\omega_Lt}}{2 \mathrm{i}}
\end{align}$$

<p>将这些结果带入之前得到的 rf current 的线性响应近似的结果</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}} \\
  =& -\int \mathrm{d}^3r \int \mathrm{d}r'\int_0^{\infty} \mathrm{d}t' \cdot\theta(t - t')
    \left\{\Omega(\vec{r}, t)\Omega^{*}(\vec{r}', t')
    \langle\left[\hat{\psi}_{eC}^{\dagger}(\vec{r}, t)\hat{\psi}_{gC}(\vec{r}, t),  \hat{\psi}_{gC}^{\dagger}(\vec{r}', t')\hat{\psi}_{eC}(\vec{r}', t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$

<p>中, 会出现以下关于 $t$ 的振动项</p>

$$\begin{align}
  \left(e^{\mathrm{i}\omega_Lt} - e^{-\mathrm{i}\omega_Lt} \right) 
e^{\frac{\mathrm{i}}{\hbar}[(E_e - E_g) - (\mu_g  - \mu_e)]t}
 = e^{\mathrm{i}[\omega_L + \frac{E_e - E_g}{\hbar} - \frac{\mu_g  - \mu_e}{\hbar}]t} 
  - e^{-\mathrm{i}[\omega_L - \frac{E_e - E_g}{\hbar} + \frac{\mu_g  - \mu_e}{\hbar}]t}
\end{align}$$

<p>做旋波近似, 略去 $\omega_L + \frac{E_e - E_g}{\hbar}$ 的高频率, 将 detuning 记为</p>

$$\begin{align}
  \tilde{\delta} = \delta + \frac{\mu_g  - \mu_e}{\hbar} = \omega_L - \frac{E_e - E_g}{\hbar} + \frac{\mu_g  - \mu_e}{\hbar}
\end{align}$$

<p>做完旋波近似后, 关于 $t$ 的振动项只剩下</p>

$$\begin{align}
  - e^{-\mathrm{i}\tilde{\delta}t}
\end{align}$$

<p>同样对关于 $t'$ 的振动项做完旋波近似后剩下</p>

$$\begin{align}
  - e^{\mathrm{i}\tilde{\delta}t'}
\end{align}$$

<p>还有两个 $\frac{1}{2\mathrm{i}}$ , 所以做完旋波近似后</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{1}{4}\int \mathrm{d}^3r \int \mathrm{d}^3r'\int_0^{\infty} \mathrm{d}t' \cdot\theta(t - t')
    \left\{\Omega(\vec{r})\Omega^{*}(\vec{r}')e^{ - \mathrm{i}\tilde{\delta}(t - t')}
    \langle\left[\hat{\psi}_{e}^{\dagger}(\vec{r}, t)\hat{\psi}_{g}(\vec{r}, t),  \hat{\psi}_{g}^{\dagger}(\vec{r}', t')\hat{\psi}_{e}(\vec{r}', t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$


<h2>rf 谱动量守恒</h2>

<blockquote>The speciality of RF spectroscopy is that the wavelength of the RF field is
large compared to other length scales in the system, typically much larger than
the cloud of atoms. Related to this, the corresponding momentum is negligible
compared to, e.g., typical scales of the Fermi momentum, and in the above
formulas can be set to zero. Furthermore, the intensity of the RF field over the
cloud can be taken as uniform in the scale of the cloud, which makes the
coupling parameter to be simply a constant.</blockquote>

<p>对于 rf 脉冲, 它的动量相对原子的动量可以忽略. rf 场的波长相对原子云的波长很大,
可以认为它的均匀的. 也就是</p>

$$\begin{align}
  \Omega (\vec{r}) = \Omega
\end{align}$$


<p>变换到动量表象</p>

$$\begin{align}
  \hat{\psi}(\vec{r}) = \frac{1}{\sqrt{\mathcal{V}}}
    \sum_{\vec{k}}\hat{c}_{\vec{k}}^{\dagger} e^{\mathrm{i}\vec{k}\cdot \vec{r}}
\end{align}$$

<p>这样就有</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int \mathrm{d}^3r \int \mathrm{d}^3r'\int_0^{t} \mathrm{d}t' 
    \sum_{\vec{k}\vec{k}'\vec{l}\vec{l}'}
    e^{\mathrm{i}(\vec{l} - \vec{k})\cdot \vec{r}}
    e^{\mathrm{i}(\vec{k}' - \vec{l}')\cdot \vec{r}'}
    \left\{e^{ - \mathrm{i}\tilde{\delta}(t - t')}
    \langle\left[\hat{c}_{ke}^{\dagger}(t)\hat{c}_{lg}(t), \hat{c}_{l'g}^{\dagger}(t')\hat{c}_{k'e}(t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$

<p>将空间部分积掉是 $\delta$ 函数, 然后求和掉 $\vec{l}', \vec{l}'$ 结果为</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int_0^{t} \mathrm{d}t' 
    \sum_{\vec{k}\vec{k}'}
      \left\{e^{ - \mathrm{i}\tilde{\delta}(t - t')}
    \langle\left[\hat{c}_{ke}^{\dagger}(t)\hat{c}_{kg}(t), \hat{c}_{k'g}^{\dagger}(t')\hat{c}_{k'e}(t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$


<h2>写成格林函数</h2>

<blockquote>The correlators above could in principle be non-zero for $k \neq k'$ and/or $l\neq
l'$ if the state possesses some non-trivial correlations between different
momentum states of the same species. However, this is not the case, for
instance, for the normal state or for the BCS state, and many other typical
many-body states. So, in our example that aims to treat such states, we
assume $k=k'$ and $l=l'$ .</blockquote>

<p>对于 normal state 和 BCS 态来说,  $k \neq k'$ 的态是不存在的, 所以就有 </p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int_0^{t} \mathrm{d}t' 
    \sum_{\vec{k}}
      \left\{e^{ - \mathrm{i}\tilde{\delta}(t - t')}
    \langle\left[\hat{c}_{ke}^{\dagger}(t)\hat{c}_{kg}(t), \hat{c}_{kg}^{\dagger}(t')\hat{c}_{ke}(t') \right]\rangle 
    + \mathrm{h.c.} \right\}
\end{align}$$

<p>推迟格林函数的定义</p>

$$\begin{align*}
G_{AB}^{\mathrm{ret}}(t,t') =-\mathrm{i}\theta(t-t')\langle [A(t),B(t')]_{-\varepsilon}\rangle
\end{align*}$$

<p>因此 $|e\rangle,|g\rangle$ 之间的推迟格林函数为</p>

$$\begin{align}
  G_{eg}(k, t - t') = -\mathrm{i}\theta(t-t')\langle\left[\hat{c}_{ke}^{\dagger}(t)\hat{c}_{kg}(t), \hat{c}_{kg}^{\dagger}(t')\hat{c}_{ke}(t')\right]\rangle
\end{align}$$

<p>所以</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int_0^{+\infty} \mathrm{d}t' 
    \sum_{\vec{k}}
      \left\{e^{ - \mathrm{i}\tilde{\delta}(t - t')}
      \mathrm{i} G_{eg}(k, t - t') 
    + \mathrm{h.c.} \right\}
\end{align}$$

<p>做变量代换 $t - t' \to t$ , $\mathrm{d}t'\to -\mathrm{d}t$ ,
 $t'\in[0, +\infty] \to t\in[t, -\infty]$ 有</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int_{-\infty}^{t} \mathrm{d}t 
    \sum_{\vec{k}}
      \left\{e^{ - \mathrm{i}\tilde{\delta}t}
      \mathrm{i} G_{eg}(k, t) 
    + \mathrm{h.c.} \right\}
\end{align}$$

<p>而格林函数在能量表象为</p>

$$\begin{align}
  G_{AB}(\omega) = \int_{-\infty}^{+\infty} \mathrm{d}(t - t') G_{AB}(t - t')e^{\mathrm{i}\omega(t - t')}
\end{align}$$

<p>所以, 当取极限时 $t\to\infty$ 时</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}, t\to\infty} \\
  =& -\frac{|\Omega|^2}{4}\int_{-\infty}^{+\infty} \mathrm{d}t 
    \sum_{\vec{k}}
      \left\{e^{ - \mathrm{i}\tilde{\delta}t}
      \mathrm{i} G_{eg}(k, t) 
    + \mathrm{h.c.} \right\} \\
  =& -\frac{|\Omega|^2}{4}
    \sum_{\vec{k}}
      \left\{
      \mathrm{i} G_{eg}(k, -\tilde{\delta}) 
    + \mathrm{h.c.} \right\} 
\end{align}$$

<p>而</p>

$$\begin{align}
  \mathrm{i} G_{eg}(k, -\tilde{\delta}) 
    + \mathrm{h.c.}
  =&   \mathrm{i} G_{eg}(k, -\tilde{\delta}) 
    -\mathrm{i} G_{eg}^{*}(k, -\tilde{\delta}) 
  = \mathrm{i}\left[ 2\mathrm{i} \mathrm{Im}G_{eg}(k, -\tilde{\delta})  \right] \\
  =& -2\mathrm{Im}G_{eg}(k, -\tilde{\delta})
\end{align}$$

<p>所以</p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}, t\to\infty} \\
  =& \frac{|\Omega|^2}{2}
    \sum_{\vec{k}}
    \mathrm{Im}G_{eg}(k, -\tilde{\delta})
\end{align}$$

<p>这里 $\tilde{\delta} = \delta + \frac{\mu_g  - \mu_e}{\hbar} = \omega_L - \frac{E_e - E_g}{\hbar} +
\frac{\mu_g  - \mu_e}{\hbar}$ . 如果 $E_e - E_g = \mu_g - \mu_e$ , 那么 $\tilde{\delta} = \omega_L$ .</p>


<h2>初末两个态没有相互作用</h2>

<blockquote>e and g are only coupled by the field. In this case, the state of the system
before the perturbation is a product of states for the species e and g which
means the four-operator correlators can be factorized to parts that contain only
e operators or g operators.</blockquote>
<p>在将 rf 脉冲作为微扰引入前, $|e\rangle ,|g\rangle$ 两个态没有相互作用, 因此四算符的关联函数
可以拆成两个二算符关联函数的乘积, 也就是</p>

$$\begin{align}
  \langle \hat{c}_{ke}^{\dagger}(t)\hat{c}_{kg}(t) \hat{c}_{k'g}^{\dagger}(t')\hat{c}_{k'e}(t') \rangle
 =   \langle \hat{c}_{ke}^{\dagger}(t)\hat{c}_{k'e}(t') \rangle
     \langle \hat{c}_{kg}(t) \hat{c}_{k'g}^{\dagger}(t') \rangle
\end{align}$$


<blockquote>The correlators above could in principle be non-zero for $k \neq k'$ and/or $l\neq
l'$ if the state possesses some non-trivial correlations between different
momentum states of the same species. However, this is not the case, for
instance, for the normal state or for the BCS state, and many other typical
many-body states. So, in our example that aims to treat such states, we
assume $k=k'$ and $l=l'$ .</blockquote>

<p>对于 normal state 和 BCS 态来说,  $k \neq k'$ 的态是不存在的, 所以就有 </p>

$$\begin{align}
  &\frac{\mathrm{d}}{\mathrm{d}t}\langle\Psi(t)|\hat{N}_{e}(t)|\Psi(t)\rangle_{1\mathrm{st}, \mathrm{rwa}} \\
  =& -\frac{|\Omega|^2}{4}\int_0^{t} \mathrm{d}t' 
    \sum_{\vec{k}}
      \left\{e^{ - \mathrm{i}\tilde{\delta}(t - t')}
    \left[
   \langle \hat{c}_{ke}^{\dagger}(t)\hat{c}_{ke}(t') \rangle\langle \hat{c}_{kg}(t) \hat{c}_{kg}^{\dagger}(t') \rangle
-  \langle \hat{c}_{kg}^{\dagger}(t')\hat{c}_{kg}(t) \rangle \langle \hat{c}_{ke}(t')\hat{c}_{ke}^{\dagger}(t) \rangle
  \right]
      + \mathrm{h.c.} \right\}
\end{align}$$




<h2>Reference</h2>

<ul>
<li>Phys. Scr. 91 (2016) 043006 ,Päivi Törmä ,Physics of ultracold Fermi gases revealed by spectroscopies</li>
<li>Torma P.,Klaus Sengstock K, Quantum Gas Experiments Exploring Many-Body States</li>
</ul>

</section>

<section class="post-meta">
    <p>
        <a class="post-link" href="https://zqw.ink/tag/wu-li.html">#物理</a>
        <a class="post-link" href="https://zqw.ink/tag/rf-current.html">#rf current</a>
        <a class="post-link" href="https://zqw.ink/tag/linear-repsonse.html">#linear repsonse</a>
        <a class="post-link" href="https://zqw.ink/tag/greens-function.html">#Green's Function</a>
    </p>
</section>

  </main>
  <footer role="contentinfo">
    <p>Copyright &copy; 2018 - 2025 ZQW</p>
  </footer>
  <script>
  (function() {
    const key = 'theme';
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const saved = localStorage.getItem(key);
    const init = saved ? saved : 'system';
    const effective = init === 'system' ? (prefersDark ? 'dark' : 'light') : init;
    document.documentElement.setAttribute('data-theme', effective);
    updateThemeButton(effective);

    document.getElementById('theme-toggle')?.addEventListener('click', function () {
      const current = document.documentElement.getAttribute('data-theme') || 'light';
      const next = current === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem(key, next);
      updateThemeButton(next);
    });

    function updateThemeButton(theme) {
      const btn = document.getElementById('theme-toggle');
      if (btn) {
        btn.setAttribute('aria-label', theme === 'dark' ? '切换到浅色模式' : '切换到深色模式');
      }
    }
  })();
  </script>
  <script>
  (function() {
    const blocks = document.querySelectorAll('pre > code');
    blocks.forEach((code) => {
      const pre = code.parentElement;
      if (!pre) return;

      if (!pre.dataset.lang) {
        const cls = Array.from(code.classList);
        const langClass = cls.find((name) => name.startsWith('language-') || name.startsWith('lang-'));
        if (langClass) {
          const raw = langClass.replace(/^language-/, '').replace(/^lang-/, '');
          pre.dataset.lang = raw.replace(/_/g, ' ').toUpperCase();
        }
      }

      if (pre.querySelector('.copy-btn')) return;
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'copy-btn';
      btn.setAttribute('aria-label', '复制代码');
      btn.textContent = 'Copy';
      btn.addEventListener('click', async function () {
        try {
          await navigator.clipboard.writeText(code.innerText);
          btn.textContent = 'Copied';
        } catch (err) {
          const range = document.createRange();
          range.selectNodeContents(code);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
          try {
            document.execCommand('copy');
            btn.textContent = 'Copied';
          } finally {
            selection.removeAllRanges();
          }
        }
        setTimeout(() => {
          btn.textContent = 'Copy';
        }, 1500);
      });
      pre.appendChild(btn);
    });
  })();
  </script>
  <script>
  (function() {
    const toggle = document.getElementById('nav-toggle');
    const nav = document.getElementById('site-nav');
    if (!toggle || !nav) return;

    function closeNav() {
      nav.classList.remove('is-open');
      toggle.setAttribute('aria-expanded', 'false');
      toggle.setAttribute('aria-label', '打开菜单');
    }

    function openNav() {
      nav.classList.add('is-open');
      toggle.setAttribute('aria-expanded', 'true');
      toggle.setAttribute('aria-label', '关闭菜单');
    }

    toggle.addEventListener('click', function (event) {
      event.stopPropagation();
      const isOpen = nav.classList.contains('is-open');
      if (isOpen) {
        closeNav();
      } else {
        openNav();
      }
    });

    nav.querySelectorAll('a').forEach((link) => {
      link.addEventListener('click', closeNav);
    });

    document.addEventListener('click', function (event) {
      if (!nav.classList.contains('is-open')) return;
      if (nav.contains(event.target) || toggle.contains(event.target)) return;
      closeNav();
    });
  })();
  </script>
</body>

</html>