<!DOCTYPE html>
<html lang="zh_cn">

<head>
    <title>从冰上的水 - Rabi's Formula (update 15/Apr/2020)</title>
  <meta charset="utf-8" />
  <meta name="generator" content="Pelican" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link
    href="https://zqw.ink/feeds/all.atom.xml"
    type="application/atom+xml" rel="alternate" title="从冰上的水 Full Atom Feed" />
  <link
    href="https://zqw.ink/feeds/zhuan-ye-bi-ji.atom.xml"
    type="application/atom+xml" rel="alternate" title="从冰上的水 Categories Atom Feed" />
  <link rel="stylesheet" type="text/css" href="https://zqw.ink/theme/css/style.css" />
  <!-- fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Long+Cang&family=Noto+Serif+SC&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.6.1/github-markdown.min.css" integrity="sha512-wpdV3v8V8vWajD1kH8rI1UO1H2q9TQ3s8o1mG7lH8fS1dZ+3q1B1p4lH2tF8rQm2u0n8oV6rN3tV4nQWmY4nTw==" crossorigin="anonymous" referrerpolicy="no-referrer">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
  <!--fonts end  -->
  <!-- highlight.js -->
  <link id="hljs-light" rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" disabled>
  <link id="hljs-dark" rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" disabled>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
    (function () {
      const light = document.getElementById('hljs-light');
      const dark = document.getElementById('hljs-dark');
      if (!light || !dark) return;

      function resolveTheme() {
        return document.documentElement.getAttribute('data-theme') || 'light';
      }

      function applyTheme(theme) {
        const isDark = theme === 'dark';
        light.disabled = isDark;
        dark.disabled = !isDark;
      }

      const observer = new MutationObserver(function () {
        applyTheme(resolveTheme());
      });
      observer.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });
      applyTheme(resolveTheme());
    })();
  </script>
  <!-- highlight.js end -->

<script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        tags: 'ams'   // 自动给 AMS 环境/显示公式编号
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.1">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.1">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.1">




    <meta name="tags" content="物理" />
    <meta name="tags" content="Rabi's Formula" />

</head>

<body>
  <header>
    <div id="header-container">
      <button id="nav-toggle" class="nav-toggle" aria-label="打开菜单" aria-expanded="false">
        <i class="fa-solid fa-bars" aria-hidden="true"></i>
      </button>
      <nav id="site-nav">
        <ul>
            <li>
              <a href="/">Home</a>
            </li>
            <li>
              <a href="/category/physics">Physics</a>
            </li>
            <li>
              <a href="/category/blog">Blog</a>
            </li>
            <li>
              <a href="/category/coding">Coding</a>
            </li>
            <li>
              <a href="/archives">All</a>
            </li>
          </ul>
      </nav>
      <div class="header-actions">
        <button id="theme-toggle" aria-label="切换到深色模式" title="切换主题">
          <i class="theme-icon icon-sun fa-solid fa-sun" aria-hidden="true"></i>
          <i class="theme-icon icon-moon fa-solid fa-moon" aria-hidden="true"></i>
        </button>
        <div class="rss">
            <a href="https://zqw.ink/feeds/all.atom.xml" aria-label="Atom 订阅">
              <i class="fa-solid fa-rss" aria-hidden="true"></i>
            </a>
        </div>
      </div>
    </div>
  </header>
  <main>

<h1 class="post-title">Rabi's Formula (update 15/Apr/2020)</h1>

<section class="post-meta">
    <p>2019-03-06</p>
    <p>-<a class="post-link" href="https://zqw.ink/category/zhuan-ye-bi-ji.html">专业笔记</a></p>
</section>

<section class="markdown-body">
  <h2>Statement of the Problem</h2>

<p>二能级系统的 Hamiltonian</p>

$$\begin{align*}
  H = H_0 + V
\end{align*}$$

<p>$H_0$ 的两个本征态为 $|1\rangle ,\,|2\rangle$ . 在这两个
本征态组成的 Hilbert 空间写出 Hamiltonian 的矩阵形式</p>

$$\begin{align*}
  H = \pmatrix{E_1 & 0 \\0 &  E_2} +
      \pmatrix{0 & V_{12} \\ V_{21} & 0}
\end{align*}$$

<p>其中 $V_{12}=V_{21}^{*} = \gamma e^{\mathrm{i}\omega t}$
在 Dirac Representation 中,
$t$ 时刻处于态 $|\psi(t) \rangle_D = c_1(t) |1\rangle +c_2(t)|2\rangle$ ,且
 $c_1(0) = 1, \quad c_2(0) = 0$</p>

<p>其中$|\psi(t) \rangle_D = e^{-\frac{1}{\mathrm{i}\hbar}H_0t}|\psi(t)\rangle$ ,
求 $c_1(t),\quad c_2(t)$</p>

<h2>Dirac Representation</h2>


$$\begin{align*}
  \mathrm{i}\hbar\frac{\partial}{\partial t}c_1(t) &=
  \mathrm{i}\hbar \frac{\partial}{\partial t} \langle 1 |\psi(t)\rangle_D \\
  &= \langle 1|\cdot\mathrm{i}\hbar \frac{\partial}{\partial t} |\psi(t)\rangle_D
\end{align*}$$


<p>而 Dirac Representation 中的运动方程</p>

$$\begin{align*}
  \mathrm{i}\hbar \frac{\partial}{\partial t} |\psi(t)\rangle _D
  = V_D |\psi(t)\rangle_D
\end{align*}$$

<p>所以</p>

$$\begin{align*}
  \mathrm{i}\hbar\frac{\partial}{\partial t}c_1(t) &=
  \langle 1 |V_D |\psi(t)\rangle_D
\end{align*}$$


<p>插入一组完备基</p>

$$\begin{align*}
  \mathrm{i}\hbar\frac{\partial}{\partial t}c_1(t) =&
  \langle 1 |V_D \cdot \left(
  |1 \rangle\langle 1| + |2\rangle\langle 2|
  \right)  \cdot |\psi(t)\rangle_D \\
  =&e^{\frac{\mathrm{i}}{\hbar}(E_1-E_1)t}V_{11}
  c_1(t) +e^{\frac{\mathrm{i}}{\hbar}(E_1-E_2)t}V_{12} c_2(t)
\end{align*}$$

<p>其中</p>

$$\begin{align*}
  V_{11}=& \langle 1| V_D |1\rangle \\
  V_{12}=& \langle 1 |V_D | 2\rangle
\end{align*}$$

<p> 同理可得 $c_2(t)$ 的微分方程</p>

<p>若记 $(E_n-E_m)/\hbar =\omega_{nm}$
, 则最终得到一个微分方程组</p>

$$\begin{align*}
  \mathrm{i}\hbar\dot{c}_1 =  V_{11} c_1
      + e^{\mathrm{i}\omega_{12}t}V_{12} c_2 \\
  \mathrm{i}\hbar  \dot{c}_2 =e^{\mathrm{i}\omega_{21}t} V_{21} c_1 +
      V_{22} c_2
\end{align*}$$


<h2>求解微分方程组</h2>

<h3>化简</h3>

<p>对于这个问题, $V_{11} = V_{22} <code>0$ , $V_{12}</code>V_{21}^{*} = \gamma e^{\mathrm{i}\omega t}$ ,所以</p>

$$\begin{align*}
  \mathrm{i}\hbar\dot{c}_1 =
      e^{\mathrm{i}\omega_{12}t}V_{12} c_2 \\
    \mathrm{i}\hbar\dot{c}_2 =e^{\mathrm{i}\omega_{21}t} V_{21} c_1
\end{align*}$$

<p>即</p>

$$\begin{align*}
  \mathrm{i}\hbar\dot{c}_1 =&
       \gamma e^{\mathrm{i}(\omega-\omega_{21})t} c_2 \tag{1}\\
    \mathrm{i}\hbar\dot{c}_2 =&\gamma e^{-\mathrm{i}(\omega-\omega_{21})t}  c_1\tag{2}
\end{align*}$$


<h3>求解</h3>

<p>$(2)$ 移项得</p>

$$\begin{align*}
  c_1 =\frac{\mathrm{i}\hbar}{\gamma}e^{\mathrm{i}(\omega-\omega_{21})t} \dot{c}_2
\end{align*}$$

<p>两边对 $t$ 求导</p>

$$\begin{align*}
  \dot{c}_1 =\frac{\mathrm{i}\hbar}{\gamma}e^{\mathrm{i}(\omega-\omega_{21})t}
  [\mathrm{i}(\omega-\omega_{21})\dot{c}_2 +\ddot{c}_2] \tag{3}
\end{align*}$$

<p>将 $(1)$ 式代入 $(3)$ 式得</p>

$$\begin{align*}
  \frac{\gamma}{\mathrm{i}\hbar} e^{\mathrm{i}(\omega-\omega_{21})t} c_2
  =\frac{\mathrm{i}\hbar}{\gamma}e^{\mathrm{i}(\omega-\omega_{21})}
  [\mathrm{i}(\omega-\omega_{21})\dot{c}_2 +\ddot{c}_2]
\end{align*}$$

<p>整理成标准形式</p>

$$\begin{align*}
  \ddot{c}_2 + \mathrm{i}(\omega-\omega_{21})\dot{c}_2 + \frac{\gamma^2}{\hbar^2}c_2 =0
\end{align*}$$

<p>其解的形式为</p>

$$\begin{align*}
  c_2(t) = e^{-\frac{\mathrm{i}}{2}(\omega-\omega_{21})t}
  \left(Ae^{\mathrm{i}\Omega t} + B e^{-\mathrm{i}\Omega t} \right) \tag{4}
\end{align*}$$

<p>其中</p>

$$\begin{align*}
  \Omega = \sqrt{\frac{(\omega-\omega_{21})^2}{4}+\frac{\gamma^2}{\hbar^2}}
\end{align*}$$

<p>$(4)$ 式代入 $(2)$ 式得</p>

$$\begin{align*}
  c_1(t)=\frac{\mathrm{i}\hbar}{\gamma}e^{\mathrm{i}(\omega-\omega_{21})t}
  \cdot e^{-\frac{\mathrm{i}}{2}(\omega-\omega_{21})t}\left[
  -\frac{i}{2}(\omega-\omega_{21})\left(Ae^{\mathrm{i}\Omega t} + B e^{-\mathrm{i}\Omega t} \right)
  + \mathrm{i}\Omega\left(Ae^{\mathrm{i}\Omega t} - B e^{-\mathrm{i}\Omega t} \right)\right]\tag{5}
\end{align*}$$

<p>将初值条件  $c_1(0) = 1, \quad c_2(0) = 0$ 代入 $(4), (5)$ 式得</p>

$$\begin{align*}
  A+B =& 0 \\
  \frac{\mathrm{i}\hbar}{\gamma}\cdot \mathrm{i}\Omega(A-B) =&1
\end{align*}$$

<p>解得</p>

$$\begin{align*}
  A =& -\frac{\gamma}{2\hbar\Omega} \\
  B =& \frac{\gamma}{2\hbar\Omega}
\end{align*}$$

<p>将系数 $A,\,B$ 的结果代入 $(4) ,\,(5)$ 式得</p>

$$\begin{align*}
  c_2(t) =& -\frac{\mathrm{i}\gamma}{\hbar\Omega} e^{-\frac{\mathrm{i}}{2}(\omega-\omega_{21})t} \sin(\Omega t) \\
  c_1(t) =&-\frac{\mathrm{i}}{2\Omega}(\omega-\omega_{21})e^{\frac{\mathrm{i}}{2}(\omega-\omega_{21})t}\sin (\Omega t)
             + e^{\frac{\mathrm{i}}{2}(\omega-\omega_{21})t}\cos (\Omega t)
\end{align*}$$

<p>取模方有</p>

$$\begin{align*}
  |c_2(t)|^2 = \frac{1}{1+\frac{\hbar^2(\omega-\omega_{21})^2}{4\gamma^2}}\sin^2\left(
  \Omega t \right)
\end{align*}$$


<h2>Results</h2>

<h3>code</h3>

<pre><code class="language-python">import numpy as np
from matplotlib import pyplot as plt
from matplotlib import animation

N = 1000

gamma = 1

t = np.linspace(0,16,N)

def c2(omega):
    Omega = np.sqrt( (omega-1)**2/4 + gamma )
    c2 = 1/( 1+(omega-1)**2/(4*gamma**2) ) \
        *np.sin(Omega*t)**2
    ax.set_xticks([np.pi/Omega, 2*np.pi/Omega, \
                   3*np.pi/Omega, 4*np.pi/Omega, \
                   5*np.pi/Omega])
    ax.set_xlim(0,4*np.pi/Omega)
    return c2

fig, ax = plt.subplots()
line, = ax.plot(t,c2(1))

#ax3 = fig.add_axes([0.1, 0.1, 0.8, 0.8])



def init():
    line.set_ydata(c2(1))
    return line

def animata(i):
    line.set_ydata(c2(1+.01*i))
#    ax.text(1+0.1*i,1,'x')
    return line

ani = animation.FuncAnimation(fig=fig, func=animata, \
                              frames=400, interval=20)

ax.set_xlabel('$t$')
ax.set_ylabel('$|c_2(t)|^2$')
ax.set_title('Plot of $|c_2(t)|^2$ at $\omega = \omega_{21}$ to $\omega =5 \omega_{21}$')

ax.set_yticks([0,0.2,0.5,1])

ax.set_xticklabels(['$\pi/\Omega$', '$2\pi/\Omega$', \
                    '$3\pi/\Omega$', '$4\pi/\Omega$', \
                    '$5\pi/\Omega$'])
ani.save('fig.gif',writer='imagemagick')
plt.show()
</code></pre>

<h3>figure</h3>

<p><p><img src='./2019-03-06-physics-RabiFormula/fig.gif' alt='figalt' max-width:100%><p></p>

<p><a href='./2019-03-06-physics-RabiFormula/fig.mp4'>./2019-03-06-physics-RabiFormula/fig.mp4</a></p>

<h2>总结</h2>

<p>如果取 $\hbar = 1$ , 记 detuning $\Delta = \omega-\omega_{21}$ , 那么对于一个二能级系统的(含时)
微扰</p>

$$\begin{align}
  V_{12} = \gamma e^{\mathrm{i}\omega t}
\end{align}$$

<p>在 Dirac 表象(态矢中去除了 $H_0$ 的演化)中</p>

$$\begin{align}
  c_2(t) =& -\frac{\mathrm{i}\gamma}{\Omega} e^{-\frac{\mathrm{i}}{2}\Delta t} \sin(\Omega t)
\end{align}$$


$$\begin{align}
  |c_2(t)|^2 = \left(\frac{\gamma}{\Omega}\right)^2\sin^2\left(
  \Omega t \right)
\end{align}$$

<p>其中 Rabi frequency $\Omega$ ( $|c_2(t)|^2$ 以 $2\Omega$ 为角频率振荡) 为</p>

$$\begin{align}
  2\Omega = \sqrt{\Delta^2+(2\gamma)^2}
\end{align}$$

<p>可以看出, detuning 越大, Rabi frequency 越大, $|c_2(t)|^2$ 振幅越小.这是当然的, 失
谐大了, 耦合就弱, 因为初态取了 $c_2(0)=0$ .</p>

<h2>Reference</h2>

<p><a href='http://farside.ph.utexas.edu/teaching/qmech/Quantum/node113.html'>http://farside.ph.utexas.edu/teaching/qmech/Quantum/node113.html</a></p>

<p>J. J. Sakurai, Jim Napolitano, Modern Quantum Mechanics 2nd</p>

</section>

<section class="post-meta">
    <p>
        <a class="post-link" href="https://zqw.ink/tag/wu-li.html">#物理</a>
        <a class="post-link" href="https://zqw.ink/tag/rabis-formula.html">#Rabi's Formula</a>
    </p>
</section>

  </main>
  <footer role="contentinfo">
    <p>Copyright &copy; 2018 - 2025 ZQW</p>
  </footer>
  <script>
  (function() {
    const key = 'theme';
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const saved = localStorage.getItem(key);
    const init = saved ? saved : 'system';
    const effective = init === 'system' ? (prefersDark ? 'dark' : 'light') : init;
    document.documentElement.setAttribute('data-theme', effective);
    updateThemeButton(effective);

    document.getElementById('theme-toggle')?.addEventListener('click', function () {
      const current = document.documentElement.getAttribute('data-theme') || 'light';
      const next = current === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', next);
      localStorage.setItem(key, next);
      updateThemeButton(next);
    });

    function updateThemeButton(theme) {
      const btn = document.getElementById('theme-toggle');
      if (btn) {
        btn.setAttribute('aria-label', theme === 'dark' ? '切换到浅色模式' : '切换到深色模式');
      }
    }
  })();
  </script>
  <script>
  (function() {
    const blocks = document.querySelectorAll('pre > code');
    blocks.forEach((code) => {
      const pre = code.parentElement;
      if (!pre) return;

      if (!pre.dataset.lang) {
        const cls = Array.from(code.classList);
        const langClass = cls.find((name) => name.startsWith('language-') || name.startsWith('lang-'));
        if (langClass) {
          const raw = langClass.replace(/^language-/, '').replace(/^lang-/, '');
          pre.dataset.lang = raw.replace(/_/g, ' ').toUpperCase();
        }
      }

      if (pre.querySelector('.copy-btn')) return;
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'copy-btn';
      btn.setAttribute('aria-label', '复制代码');
      btn.textContent = 'Copy';
      btn.addEventListener('click', async function () {
        try {
          await navigator.clipboard.writeText(code.innerText);
          btn.textContent = 'Copied';
        } catch (err) {
          const range = document.createRange();
          range.selectNodeContents(code);
          const selection = window.getSelection();
          selection.removeAllRanges();
          selection.addRange(range);
          try {
            document.execCommand('copy');
            btn.textContent = 'Copied';
          } finally {
            selection.removeAllRanges();
          }
        }
        setTimeout(() => {
          btn.textContent = 'Copy';
        }, 1500);
      });
      pre.appendChild(btn);
    });
  })();
  </script>
  <script>
  (function() {
    const toggle = document.getElementById('nav-toggle');
    const nav = document.getElementById('site-nav');
    if (!toggle || !nav) return;

    function closeNav() {
      nav.classList.remove('is-open');
      toggle.setAttribute('aria-expanded', 'false');
      toggle.setAttribute('aria-label', '打开菜单');
    }

    function openNav() {
      nav.classList.add('is-open');
      toggle.setAttribute('aria-expanded', 'true');
      toggle.setAttribute('aria-label', '关闭菜单');
    }

    toggle.addEventListener('click', function (event) {
      event.stopPropagation();
      const isOpen = nav.classList.contains('is-open');
      if (isOpen) {
        closeNav();
      } else {
        openNav();
      }
    });

    nav.querySelectorAll('a').forEach((link) => {
      link.addEventListener('click', closeNav);
    });

    document.addEventListener('click', function (event) {
      if (!nav.classList.contains('is-open')) return;
      if (nav.contains(event.target) || toggle.contains(event.target)) return;
      closeNav();
    });
  })();
  </script>
</body>

</html>